<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Converts between epidemiological parameters related to \(R_0\) — r0_conversions • finalsize</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Converts between epidemiological parameters related to \(R_0\) — r0_conversions"><meta name="description" content="Converts between \(R_0\) and the transmission rate
\(\lambda\), or calculates
the effective reproduction number \(R_\text{eff}\) for a population,
while accounting for population characteristics including demographic
heterogeneity in social contacts, heterogeneity in the demographic
distribution, and heterogeneity in susceptibility to infection.
Uses the R0 (\(R_0\)), contact matrix (\(C\)),
population (\(N\)), and infectious period (\(\gamma\))
to calculate the transmission rate using the following equation.
$$\lambda = R_0 / ({Max}(EV(C)) \gamma)$$
where \(EV(C)\) denotes the eigenvalues of the matrix \(C\) which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population."><meta property="og:description" content="Converts between \(R_0\) and the transmission rate
\(\lambda\), or calculates
the effective reproduction number \(R_\text{eff}\) for a population,
while accounting for population characteristics including demographic
heterogeneity in social contacts, heterogeneity in the demographic
distribution, and heterogeneity in susceptibility to infection.
Uses the R0 (\(R_0\)), contact matrix (\(C\)),
population (\(N\)), and infectious period (\(\gamma\))
to calculate the transmission rate using the following equation.
$$\lambda = R_0 / ({Max}(EV(C)) \gamma)$$
where \(EV(C)\) denotes the eigenvalues of the matrix \(C\) which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population."><meta property="og:image" content="https://epiverse-trace.github.io/finalsize/logo.svg"><meta name="robots" content="noindex"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">finalsize</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/finalsize.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/varying_contacts.html">Modelling heterogeneous social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/varying_susceptibility.html">Modelling heterogeneous susceptibility</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_params.html">Modelling uncertainty in R₀</a></li>
    <li><a class="dropdown-item" href="../articles/demographic_turnover.html">Projecting re-emergence risk after waning or new births</a></li>
    <li><a class="dropdown-item" href="../articles/r_eff_reckoner.html">Ready reckoner for R&lt;sub&gt;eff&lt;/sub&gt;</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling guides and background</h6></li>
    <li><a class="dropdown-item" href="../articles/theoretical_background.html">Theoretical background</a></li>
    <li><a class="dropdown-item" href="../articles/compare_sir_model.html">Comparison with a compartmental model</a></li>
    <li><a class="dropdown-item" href="../articles/susceptibility_matrices.html">Guide to constructing susceptibility matrices</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/finalsize/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Converts between epidemiological parameters related to \(R_0\)</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/finalsize/blob/main/R/r0_conversions.R" class="external-link"><code>R/r0_conversions.R</code></a></small>
      <div class="d-none name"><code>r0_conversions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Converts between \(R_0\) and the transmission rate
\(\lambda\), or calculates
the effective reproduction number \(R_\text{eff}\) for a population,
while accounting for population characteristics including demographic
heterogeneity in social contacts, heterogeneity in the demographic
distribution, and heterogeneity in susceptibility to infection.</p>
<p>Uses the R0 (\(R_0\)), contact matrix (\(C\)),
population (\(N\)), and infectious period (\(\gamma\))
to calculate the transmission rate using the following equation.
$$\lambda = R_0 / ({Max}(EV(C)) \gamma)$$
where \(EV(C)\) denotes the eigenvalues of the matrix \(C\) which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lambda_to_r0</span><span class="op">(</span></span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">contact_matrix</span>,</span>
<span>  <span class="va">demography_vector</span>,</span>
<span>  <span class="va">susceptibility</span>,</span>
<span>  <span class="va">p_susceptibility</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="fl">1.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">r0_to_lambda</span><span class="op">(</span></span>
<span>  <span class="va">r0</span>,</span>
<span>  <span class="va">contact_matrix</span>,</span>
<span>  <span class="va">demography_vector</span>,</span>
<span>  <span class="va">susceptibility</span>,</span>
<span>  <span class="va">p_susceptibility</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="fl">1.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">r_eff</span><span class="op">(</span></span>
<span>  <span class="va">r0</span>,</span>
<span>  <span class="va">contact_matrix</span>,</span>
<span>  <span class="va">demography_vector</span>,</span>
<span>  <span class="va">susceptibility</span>,</span>
<span>  <span class="va">p_susceptibility</span>,</span>
<span>  contact_scaling <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>The transmission rate of the disease, also called the 'force of
infection' (\(\lambda\)). This is different from the effective
transmission rate (\(\beta\)).</p></dd>


<dt id="arg-contact-matrix">contact_matrix<a class="anchor" aria-label="anchor" href="#arg-contact-matrix"></a></dt>
<dd><p>Social contact matrix. Entry \(m_{ij}\) gives average
number of contacts in group \(i\) reported by participants in group \(j\)</p></dd>


<dt id="arg-demography-vector">demography_vector<a class="anchor" aria-label="anchor" href="#arg-demography-vector"></a></dt>
<dd><p>Demography vector. Entry \(v_{i}\) gives
proportion of total population in group \(i\).</p></dd>


<dt id="arg-susceptibility">susceptibility<a class="anchor" aria-label="anchor" href="#arg-susceptibility"></a></dt>
<dd><p>A matrix giving the susceptibility of individuals in
demographic group \(i\) and risk group \(k\).</p></dd>


<dt id="arg-p-susceptibility">p_susceptibility<a class="anchor" aria-label="anchor" href="#arg-p-susceptibility"></a></dt>
<dd><p>A matrix giving the probability that an individual
in demography group \(i\) is in risk (or susceptibility) group \(k\).
Each row represents the overall distribution of individuals in demographic
group \(i\) across risk groups, and each row <em>must sum to 1.0</em>.</p></dd>


<dt id="arg-infectious-period">infectious_period<a class="anchor" aria-label="anchor" href="#arg-infectious-period"></a></dt>
<dd><p>Duration of the infectious period in days.
Default value is 1.8 days.</p></dd>


<dt id="arg-r-">r0<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>The basic reproductive number \(R_0\) of the infection.</p></dd>


<dt id="arg-contact-scaling">contact_scaling<a class="anchor" aria-label="anchor" href="#arg-contact-scaling"></a></dt>
<dd><p>For <code>r_eff()</code>, either a single number or a numeric
vector of the same length as <code>demography_vector</code>, giving the proportional
scaling of contacts of each demographic group. Values must be in the range
\([0, 1]\). Defaults to 1.0 for no scaling.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a single number for the calculated value.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given the transmission rate (\(\lambda\)),
social contacts matrix (\(c\)), demography (\(N\)), the
distribution \(P\) of each demographic group \(i\) into
susceptibility groups \(S\), and the infectious period (\(\gamma\))</p><ul><li><p><code>r_eff()</code> calculates the effective reproductive number;</p></li>
<li><p><code>lamda_to_r0()</code> calculates the \(R_0\) from the transmission rate as
$$R_0 = {Max}(EV(C)) \times \lambda \gamma$$</p></li>
<li><p><code>r0_to_lambda()</code> calculates the transmission rate as
$$\lambda = R_0 / ({Max}(EV(C)) \gamma)$$
Note that this is also called the 'force of infection' and is different from
the effective transmission rate often denoted \(\beta\).</p></li>
</ul><p>Here, \(EV(C)\) denotes the eigenvalues of the matrix \(C\) which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Prepare data ####</span></span></span>
<span class="r-in"><span><span class="co"># Get example dataset and prepare contact matrix and demography</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">polymod_uk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="va">polymod_uk</span><span class="op">$</span><span class="va">contact_matrix</span></span></span>
<span class="r-in"><span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">polymod_uk</span><span class="op">$</span><span class="va">demography_vector</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define lambda</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define infectious period of 5 days</span></span></span>
<span class="r-in"><span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="co"># define the number of age and susceptibility groups</span></span></span>
<span class="r-in"><span><span class="va">n_demo_grps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n_risk_grps</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In this example, risk varies across groups</span></span></span>
<span class="r-in"><span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">1.0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_demo_grps</span>, ncol <span class="op">=</span> <span class="va">n_risk_grps</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># risk does not vary within groups</span></span></span>
<span class="r-in"><span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">n_demo_grps</span>, ncol <span class="op">=</span> <span class="va">n_risk_grps</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># p_susceptibility rows must sum to 1.0</span></span></span>
<span class="r-in"><span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="va">p_susceptibility</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">p_susceptibility</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Effective R ####</span></span></span>
<span class="r-in"><span><span class="va">r0</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span></span>
<span class="r-in"><span><span class="fu">r_eff</span><span class="op">(</span></span></span>
<span class="r-in"><span>  r0 <span class="op">=</span> <span class="va">r0</span>,</span></span>
<span class="r-in"><span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span></span>
<span class="r-in"><span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span></span>
<span class="r-in"><span>  susceptibility <span class="op">=</span> <span class="va">susceptibility</span>,</span></span>
<span class="r-in"><span>  p_susceptibility <span class="op">=</span> <span class="va">p_susceptibility</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.424081</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a 5% reduction in contacts</span></span></span>
<span class="r-in"><span><span class="fu">r_eff</span><span class="op">(</span></span></span>
<span class="r-in"><span>  r0 <span class="op">=</span> <span class="va">r0</span>,</span></span>
<span class="r-in"><span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span></span>
<span class="r-in"><span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span></span>
<span class="r-in"><span>  susceptibility <span class="op">=</span> <span class="va">susceptibility</span>,</span></span>
<span class="r-in"><span>  p_susceptibility <span class="op">=</span> <span class="va">p_susceptibility</span>,</span></span>
<span class="r-in"><span>  contact_scaling <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.319694</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Transmission rate to R0 ####</span></span></span>
<span class="r-in"><span><span class="fu">lambda_to_r0</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">lambda</span>, <span class="va">contact_matrix</span>, <span class="va">demography_vector</span>,</span></span>
<span class="r-in"><span>  <span class="va">susceptibility</span>, <span class="va">p_susceptibility</span>,</span></span>
<span class="r-in"><span>  <span class="va">infectious_period</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.068061</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### R0 to Transmission rate ####</span></span></span>
<span class="r-in"><span><span class="va">r0</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="fu">r0_to_lambda</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r0</span>, <span class="va">contact_matrix</span>, <span class="va">demography_vector</span>,</span></span>
<span class="r-in"><span>  <span class="va">susceptibility</span>, <span class="va">p_susceptibility</span>,</span></span>
<span class="r-in"><span>  <span class="va">infectious_period</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1817514</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik Gupte, Edwin Van Leeuwen, Adam Kucharski, Rosalind Eggo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

