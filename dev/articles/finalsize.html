<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="finalsize">
<title>Calculating the final size of an epidemic • finalsize</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating the final size of an epidemic">
<meta property="og:description" content="finalsize">
<meta property="og:image" content="https://epiverse-trace.github.io/finalsize/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">finalsize</a>

    <small class="nav-text text-danger me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/finalsize.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package vignettes</h6>
    <a class="dropdown-item" href="../articles/varying_contacts.html">Modelling heterogeneous social contacts</a>
    <a class="dropdown-item" href="../articles/varying_susceptibility.html">Modelling heterogeneous susceptibility</a>
    <a class="dropdown-item" href="../articles/uncertainty_params.html">Modelling uncertainty in R₀</a>
    <a class="dropdown-item" href="../articles/demographic_turnover.html">Projecting re-emergence risk after waning or new births</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Modelling guides and background</h6>
    <a class="dropdown-item" href="../articles/compare_sir_model.html">Comparison with a compartmental model</a>
    <a class="dropdown-item" href="../articles/susceptibility_matrices.html">Guide to constructing susceptibility matrices</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/finalsize/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculating the final size of an epidemic</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/finalsize/blob/HEAD/vignettes/finalsize.Rmd" class="external-link"><code>vignettes/finalsize.Rmd</code></a></small>
      <div class="d-none name"><code>finalsize.Rmd</code></div>
    </div>

    
    
<p>When analysing an epidemic-prone infection, such as pandemic influenza, it is important to understand how many infections there could be in total. The overall number of infections that occur during such an epidemic, is called the ‘final epidemic size’.
The expected final size of an epidemic can be calculated using methods detailed in <span class="citation">Andreasen (<a href="#ref-andreasen2011" role="doc-biblioref">2011</a>)</span>, <span class="citation">Miller (<a href="#ref-miller2012" role="doc-biblioref">2012</a>)</span>, <span class="citation">Kucharski et al. (<a href="#ref-kucharski2014" role="doc-biblioref">2014</a>)</span>, and <span class="citation">Bidari et al. (<a href="#ref-bidari2016" role="doc-biblioref">2016</a>)</span>, and which are implemented in the <em>finalsize</em> package.</p>
<p>An advantage of the final size approach is that it is only necessary to define pathogen transmissibility and population susceptibility to calculate the epidemic size, rather than requiring estimates of additional time-dependent processes like the duration of infectiousness or delay from infection to onset of symptoms. So <em>finalsize</em> will be particularly relevant for questions where understanding the overall size of an epidemic is more important than estimating its shape.</p>
<div class="section level2 unnumbered alert alert-primary">
<h2 id="use-case">Use case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<p>An epidemic is underway. We want to know <strong>how many individuals we would expect to be infected in total</strong> for a given level of transmission and population susceptibility: this is the cumulative sum of all infections, or the <em>final size</em> of the epidemic.</p>
</div>
<div class="alert alert-secondary">
<div class="section level3 unnumbered">
<h3 id="what-we-have">What we have<a class="anchor" aria-label="anchor" href="#what-we-have"></a>
</h3>
<ol style="list-style-type: decimal">
<li>An estimate of the infection’s basic reproduction number <span class="math inline">\(R_0\)</span>;</li>
<li>An estimate of the population size;</li>
<li>An estimate of the susceptibility of the population to the infection.</li>
</ol>
</div>
<div class="section level3 unnumbered">
<h3 id="what-we-assume">What we assume<a class="anchor" aria-label="anchor" href="#what-we-assume"></a>
</h3>
<ol style="list-style-type: decimal">
<li>That the infection dynamics can be captured using a Susceptible-Infectious-Recovered (SIR) or Susceptible-Exposed-Infectious-Recovered (SEIR) model, where individuals who have been infected acquire immunity against subsequent infection, at least for the remaining duration of the epidemic.</li>
</ol>
</div>
</div>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load finalsize</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="section level2">
<h2 id="defining-a-value-for-r_0">Defining a value for <span class="math inline">\(R_0\)</span><a class="anchor" aria-label="anchor" href="#defining-a-value-for-r_0"></a>
</h2>
<p>A number of statistical methods can be used to estimate the <span class="math inline">\(R_0\)</span> of an epidemic in its early stages from available data. These are not discussed here, but some examples are given in the <a href="https://epiverse-trace.github.io/episoap/articles/episoap.html" class="external-link"><em>episoap</em> package</a>.</p>
<p>Instead, this example considers a infection with an <span class="math inline">\(R_0\)</span> of 1.5, similar to that which could potentially be observed for pandemic influenza.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define r0 as 1.5</span></span>
<span><span class="va">r0</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="getting-population-estimates">Getting population estimates<a class="anchor" aria-label="anchor" href="#getting-population-estimates"></a>
</h2>
<p>Population estimates at the country scale are relatively easy to get from trusted data aggregators such as <a href="https://ourworldindata.org/world-population-growth" class="external-link">Our World in Data</a>.
More detailed breakdowns of population estimates at the sub-national scale may be available from their respective national governments.
Here, we use an estimate for the U.K. population size of about 67 million.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get UK population size</span></span>
<span><span class="va">uk_pop</span> <span class="op">&lt;-</span> <span class="fl">67</span> <span class="op">*</span> <span class="fl">1e6</span></span></code></pre></div>
</details><p>This initial example assumes uniform mixing, i.e., that all individuals in the population have a similar number of social contacts. This can be modelled in the form of a single-element contact matrix, which must be divided by the population size.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span> <span class="op">/</span> <span class="va">uk_pop</span></span></code></pre></div>
</details><div class="alert alert-secondary">
<p>Social contacts are well known to be non-uniform, with age being a strong influence on how many contacts a person has and, moreover, on the ages of their contacts. A relatively simple example is that of children of school-going age, who typically have more social contacts than the elderly, and most of whose social contacts are with other schoolchildren.</p>
<p>The <a href="varying_contacts.Rmd">“Modelling heterogeneous contacts”</a> vignette explores how this can be incorporated into final epidemic size calculations using <em>finalsize</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="modelling-population-susceptibility">Modelling population susceptibility<a class="anchor" aria-label="anchor" href="#modelling-population-susceptibility"></a>
</h2>
<p>In this initial example, the population is assumed to be fully susceptible to infection. This is modelled in the form of a matrix with a single element, called <code>susceptibility</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all individuals are fully susceptible</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
</details><p>Since all individuals are fully susceptible, the break-up of the population into susceptibility groups can be represented as another single-element matrix, called <code>p_susceptibility</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all individuals are in the single, high-susceptibility group</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
</details><div class="alert alert-secondary">
<p>Susceptibility to infection is well known to vary due to a number of factors, including age, prior exposure to the pathogen, or immunisation due to a vaccination campaign.</p>
<p>The <a href="varying_susceptibility.html">“Modelling heterogeneous susceptibility”</a> vignette explores how variation in susceptibility within and between demographic groups can be incorporated into final epidemic size calculations using <em>finalsize</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-final_size">Running <code>final_size</code><a class="anchor" aria-label="anchor" href="#running-final_size"></a>
</h2>
<p>The final size of the epidemic in the population can then be calculated using the only function in the package, <code><a href="../reference/final_size.html">final_size()</a></code>. This example allows the function to fall back on the default options for the arguments <code>solver</code> (<code>"iterative"</code>) and <code>control</code> (an empty list).</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate final size</span></span>
<span><span class="va">final_size_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/final_size.html">final_size</a></span><span class="op">(</span></span>
<span>  r0 <span class="op">=</span> <span class="va">r0</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">uk_pop</span>,</span>
<span>  susceptibility <span class="op">=</span> <span class="va">susceptibility</span>,</span>
<span>  p_susceptibility <span class="op">=</span> <span class="va">p_susceptibility</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the output data frame</span></span>
<span><span class="va">final_size_data</span></span>
<span><span class="co">#&gt;     demo_grp   susc_grp susceptibility p_infected</span></span>
<span><span class="co">#&gt; 1 demo_grp_1 susc_grp_1              1  0.5828132</span></span></code></pre></div>
</details><p>This is the final epidemic size without accounting for heterogeneity in social contacts by age or other factors, and without accounting for variation in susceptibility to infection between or within demographic groups.</p>
<p>This value, of about 58% of the population infected, is easily converted to a count, and suggests that about 39 million people would be infected over the course of this epidemic.</p>
</div>
<div class="section level2">
<h2 id="a-short-cut-for-homogeneous-populations">A short-cut for homogeneous populations<a class="anchor" aria-label="anchor" href="#a-short-cut-for-homogeneous-populations"></a>
</h2>
<p>The example above explains the steps that go into final size calculation.
For one very specific use-case, wherein the population is assumed to have homogeneous mixing (i.e., groups do not differ in their social contacts), and homogeneous and full susceptibility to infection, the final size calculation only depends on the <span class="math inline">\(R_0\)</span> of the epidemic.</p>
<p>In this case, the final size calculation can be simplified to <code>final_size(r0)</code>, with all other parameters taking their default values, which assume homogeneous social contacts and susceptibility.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/final_size.html">final_size</a></span><span class="op">(</span><span class="va">r0</span><span class="op">)</span></span>
<span><span class="co">#&gt;     demo_grp   susc_grp susceptibility p_infected</span></span>
<span><span class="co">#&gt; 1 demo_grp_1 susc_grp_1              1  0.5828132</span></span></code></pre></div>
</details>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-andreasen2011" class="csl-entry">
Andreasen, Viggo. 2011. <span>“The Final Size of an Epidemic and Its Relation to the Basic Reproduction Number.”</span> <em>Bulletin of Mathematical Biology</em> 73 (10): 2305–21. <a href="https://doi.org/10.1007/s11538-010-9623-3" class="external-link">https://doi.org/10.1007/s11538-010-9623-3</a>.
</div>
<div id="ref-bidari2016" class="csl-entry">
Bidari, Subekshya, Xinying Chen, Daniel Peters, Dylanger Pittman, and Péter L. Simon. 2016. <span>“Solvability of Implicit Final Size Equations for SIR Epidemic Models.”</span> <em>Mathematical Biosciences</em> 282 (December): 181–90. <a href="https://doi.org/10.1016/j.mbs.2016.10.012" class="external-link">https://doi.org/10.1016/j.mbs.2016.10.012</a>.
</div>
<div id="ref-kucharski2014" class="csl-entry">
Kucharski, Adam J., Kin O. Kwok, Vivian W. I. Wei, Benjamin J. Cowling, Jonathan M. Read, Justin Lessler, Derek A. Cummings, and Steven Riley. 2014. <span>“The contribution of social behaviour to the transmission of influenza A in a human population.”</span> <em>PLoS pathogens</em> 10 (6): e1004206. <a href="https://doi.org/10.1371/journal.ppat.1004206" class="external-link">https://doi.org/10.1371/journal.ppat.1004206</a>.
</div>
<div id="ref-miller2012" class="csl-entry">
Miller, Joel C. 2012. <span>“A Note on the Derivation of Epidemic Final Sizes.”</span> <em>Bulletin of Mathematical Biology</em> 74 (9): 2125–41. <a href="https://doi.org/10.1007/s11538-012-9749-6" class="external-link">https://doi.org/10.1007/s11538-012-9749-6</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pratik Gupte, Edwin Van Leeuwen, Adam Kucharski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
