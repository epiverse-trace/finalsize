<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Guide to constructing susceptibility matrices • finalsize</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Guide to constructing susceptibility matrices">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">finalsize</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/finalsize.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/varying_contacts.html">Modelling heterogeneous social contacts</a></li>
    <li><a class="dropdown-item" href="../articles/varying_susceptibility.html">Modelling heterogeneous susceptibility</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty_params.html">Modelling uncertainty in R₀</a></li>
    <li><a class="dropdown-item" href="../articles/demographic_turnover.html">Projecting re-emergence risk after waning or new births</a></li>
    <li><a class="dropdown-item" href="../articles/r_eff_reckoner.html">Ready reckoner for R&lt;sub&gt;eff&lt;/sub&gt;</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling guides and background</h6></li>
    <li><a class="dropdown-item" href="../articles/theoretical_background.html">Theoretical background</a></li>
    <li><a class="dropdown-item" href="../articles/compare_sir_model.html">Comparison with a compartmental model</a></li>
    <li><a class="dropdown-item" href="../articles/susceptibility_matrices.html">Guide to constructing susceptibility matrices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/finalsize/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Guide to constructing susceptibility matrices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/finalsize/blob/main/vignettes/susceptibility_matrices.Rmd" class="external-link"><code>vignettes/susceptibility_matrices.Rmd</code></a></small>
      <div class="d-none name"><code>susceptibility_matrices.Rmd</code></div>
    </div>

    
    
<p>Modelling the final size of an epidemic using <em>finalsize</em> requires us to represent the susceptibility status of multiple demographic groups, as well as the proportions of each demographic group in potentially many susceptibility groups. This is done in final size calculations by representing the relevant system of differential equations <span class="citation">(<a href="#ref-miller2012">Miller 2012</a>)</span> in matrix form. R’s matrix class allows us to easily represent <em>multiple</em> demographic groups with <em>multiple</em> susceptibility groups.</p>
<p>This guide explains how to construct susceptibility (<code>susceptibility</code>) and demography-in-susceptibility (<code>p_susceptibility</code>) matrices to represent various scenarios that we might wish to model when estimating epidemic final sizes.</p>
<div class="alert alert-warning">
<p><strong>New to <em>finalsize</em>?</strong> It may help to read the <a href="finalsize.html">“Get started”</a> vignette first!</p>
</div>
<div class="section level2 unnumbered alert alert-primary">
<h2 id="use-case">Use case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<p>You need to create <strong>two matrices</strong>, <code>susceptibility</code> and <code>p_susceptibility</code>, to pass to the two arguments of the <code><a href="../reference/final_size.html">final_size()</a></code> function. Here are five case examples with different scenarios for the content of each matrix.</p>
</div>
<div class="alert alert-secondary">
<div class="section level3 unnumbered">
<h3 id="what-we-have">What we have<a class="anchor" aria-label="anchor" href="#what-we-have"></a>
</h3>
<ol style="list-style-type: decimal">
<li>A scenario in which all individuals are equally susceptible to an infection; or,</li>
<li>A scenario in which older individuals are more susceptible to infection than younger individuals; or,</li>
<li>A scenario in which susceptibility increases with age, but older individuals benefit from immunization.</li>
</ol>
</div>
<div class="section level3 unnumbered">
<h3 id="what-we-assume">What we assume<a class="anchor" aria-label="anchor" href="#what-we-assume"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Complete partitioning of individuals into different demographic and susceptibility groups, i.e., that all individuals in the population fall into only one demographic group, and only one susceptibility group.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="primer-on-susceptibility-matrices">Primer on susceptibility matrices<a class="anchor" aria-label="anchor" href="#primer-on-susceptibility-matrices"></a>
</h2>
<div class="section level3">
<h3 id="susceptibility-matrix">Susceptibility matrix<a class="anchor" aria-label="anchor" href="#susceptibility-matrix"></a>
</h3>
<p>Represents the <em><strong>probability of infection</strong></em> of each combination of demographic and infection-risk groups.</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
i \; demographic \; groups \left.\vphantom{\begin{matrix}
s_{1,1} &amp; s_{1,2} &amp; \cdots &amp; s_{1,j} \\
s_{2,1} &amp; s_{2,2} &amp; \cdots &amp; s_{2,j} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
s_{i,1} &amp; s_{i,2} &amp; \cdots &amp; s_{i,j}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
s_{1,1} &amp; s_{1,2} &amp; \cdots &amp; s_{1,j} \\
s_{2,1} &amp; s_{2,2} &amp; \cdots &amp; s_{2,j} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
s_{i,1} &amp; s_{i,2} &amp; \cdots &amp; s_{i,j}
\end{matrix}}^{\displaystyle j \; susceptibility \; groups}
\quad
s: susceptibility
\]</span></p>
<p>Each element <span class="math inline">\(\{i, j\}\)</span> in this matrix represents the susceptibility of individuals in demographic group <span class="math inline">\(\{i\}\)</span> (rows), and susceptibility group <span class="math inline">\(\{j\}\)</span> (columns).</p>
</div>
<div class="alert alert-warning">
<p>A common example of a demographic group in a population is an age group, and each population is typically made up of multiple age groups.</p>
<p>Examples of infection-risk groups may include individuals of different immunization status, or with different prior exposure to pathogens. Final size calculations allow us to specify a different susceptibility to infection for each demography and risk group combination (e.g. fully vaccinated people over 65 years old).</p>
</div>
</div>
<div class="section level3">
<h3 id="demography-in-susceptibility-matrix">Demography-in-susceptibility matrix<a class="anchor" aria-label="anchor" href="#demography-in-susceptibility-matrix"></a>
</h3>
<p>Represents the <em><strong>proportion (or probability)</strong></em> that individuals in a demographic group are also in a specific susceptibility group.</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
i \; demographic \; groups \left.\vphantom{\begin{matrix}
p_{1,1} &amp; p_{1,2} &amp; \cdots &amp; p_{1,j} \\
p_{2,1} &amp; p_{2,2} &amp; \cdots &amp; p_{2,j} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
p_{i,1} &amp; p_{i,2} &amp; \cdots &amp; p_{i,j}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
p_{1,1} &amp; p_{1,2} &amp; \cdots &amp; p_{1,j} \\
p_{2,1} &amp; p_{2,2} &amp; \cdots &amp; p_{2,j} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
p_{i,1} &amp; p_{i,2} &amp; \cdots &amp; p_{i,j}
\end{matrix}}^{\displaystyle j \; susceptibility \; groups}
\quad
p: probability
\]</span></p>
<p>Each element <span class="math inline">\(\{i, j\}\)</span> in this matrix represents the proportion of each demographic group <span class="math inline">\(\{i\}\)</span> that falls into the susceptibility group <span class="math inline">\(\{j\}\)</span>. Consequently, each of its <strong>rows must always sum to 1.0</strong>.</p>
</div>
<p>Here we share five case examples with different scenarios and how each influences the content and structure of the two matrices.</p>
</div>
</div>
<div class="section level2">
<h2 id="homogeneous-susceptibility">Homogeneous susceptibility<a class="anchor" aria-label="anchor" href="#homogeneous-susceptibility"></a>
</h2>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="section level3">
<h3 id="case-1-uniform-susceptibility">Case 1: Uniform susceptibility<a class="anchor" aria-label="anchor" href="#case-1-uniform-susceptibility"></a>
</h3>
<p>This scenario assumes that all individuals from all age groups in the population of interest have 80% susceptibility to the infection.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># susceptibility matrix</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">susceptibility</span></span>
<span><span class="co">#&gt;         susceptible</span></span>
<span><span class="co">#&gt; [0,5)           0.8</span></span>
<span><span class="co">#&gt; [5,18)          0.8</span></span>
<span><span class="co">#&gt; [18,40)         0.8</span></span>
<span><span class="co">#&gt; [40,65)         0.8</span></span>
<span><span class="co">#&gt; 65+             0.8</span></span></code></pre></div>
</details><div class="alert alert-warning">
<p>In this example, all individuals and age groups are equally susceptible to infection; thus, the <strong>susceptibility matrix</strong> (<code>susceptibility</code>) has only a single column with identical values.</p>
</div>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># demography-in-susceptibility matrix</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_susceptibility</span></span>
<span><span class="co">#&gt;         susceptible</span></span>
<span><span class="co">#&gt; [0,5)             1</span></span>
<span><span class="co">#&gt; [5,18)            1</span></span>
<span><span class="co">#&gt; [18,40)           1</span></span>
<span><span class="co">#&gt; [40,65)           1</span></span>
<span><span class="co">#&gt; 65+               1</span></span></code></pre></div>
</details><div class="alert alert-warning">
<p>The <strong>susceptibility matrix</strong> (<code>susceptibility</code>) and the <strong>demography-in-susceptibility matrix</strong> (<code>p_susceptibility</code>) must always have the same dimensions.</p>
<p><span class="math display">\[
4 \; demo. \; groups \left.\vphantom{\begin{matrix}
s_{1,1} \\
s_{2,1} \\
s_{3,1} \\
s_{4,1}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
s_{1,1} \\
s_{2,1} \\
s_{3,1} \\
s_{4,1}
\end{matrix}}^{\displaystyle 1 \; susceptibility \; group}
\quad
4 \; demo. \; groups \left.\vphantom{\begin{matrix}
p_{1,1} \\
p_{2,1} \\
p_{3,1} \\
p_{4,1}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
p_{1,1} \\
p_{2,1} \\
p_{3,1} \\
p_{4,1}
\end{matrix}}^{\displaystyle 1 \; susceptibility \; group}
\]</span></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="heterogeneous-susceptibility">Heterogeneous susceptibility<a class="anchor" aria-label="anchor" href="#heterogeneous-susceptibility"></a>
</h2>
<div class="section level3">
<h3 id="case-2-susceptibility-varies-between-groups">Case 2: Susceptibility varies between groups<a class="anchor" aria-label="anchor" href="#case-2-susceptibility-varies-between-groups"></a>
</h3>
<p>This scenario assumes that, in the population, there is different susceptibility to the infection between individuals of different age groups, from 20% (infants) to 100% (65+).</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># susceptibility matrix</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">susceptibility</span></span>
<span><span class="co">#&gt;         susceptible</span></span>
<span><span class="co">#&gt; [0,5)           0.2</span></span>
<span><span class="co">#&gt; [5,18)          0.5</span></span>
<span><span class="co">#&gt; [18,40)         0.6</span></span>
<span><span class="co">#&gt; [40,65)         0.9</span></span>
<span><span class="co">#&gt; 65+             1.0</span></span>
<span></span>
<span><span class="co"># demography-in-susceptibility matrix</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_susceptibility</span></span>
<span><span class="co">#&gt;         susceptible</span></span>
<span><span class="co">#&gt; [0,5)             1</span></span>
<span><span class="co">#&gt; [5,18)            1</span></span>
<span><span class="co">#&gt; [18,40)           1</span></span>
<span><span class="co">#&gt; [40,65)           1</span></span>
<span><span class="co">#&gt; 65+               1</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="case-3-susceptibility-varies-both-between-and-within-groups">Case 3: Susceptibility varies both between and within groups<a class="anchor" aria-label="anchor" href="#case-3-susceptibility-varies-both-between-and-within-groups"></a>
</h3>
<p>This scenario assumes that, in the population, there is different susceptibility to the infection:</p>
<ul>
<li><p>between individuals of different age groups from 20% (infants) to 100% (65+), and</p></li>
<li><p>within individuals of the same age group due the immunization effect of 25% to the 40% of each of the age groups.</p></li>
</ul>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">immunization_effect</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="co"># susceptibility matrix</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  unimmunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>immunised <span class="op">=</span> <span class="va">unimmunised</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">immunization_effect</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">susceptibility</span></span>
<span><span class="co">#&gt;         unimmunised immunised</span></span>
<span><span class="co">#&gt; [0,5)           0.2     0.150</span></span>
<span><span class="co">#&gt; [5,18)          0.5     0.375</span></span>
<span><span class="co">#&gt; [18,40)         0.6     0.450</span></span>
<span><span class="co">#&gt; [40,65)         0.9     0.675</span></span>
<span><span class="co">#&gt; 65+             1.0     0.750</span></span>
<span></span>
<span><span class="co"># demography-in-susceptibility matrix</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  immunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unimmunised <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">immunised</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_susceptibility</span></span>
<span><span class="co">#&gt;         immunised unimmunised</span></span>
<span><span class="co">#&gt; [0,5)         0.4         0.6</span></span>
<span><span class="co">#&gt; [5,18)        0.4         0.6</span></span>
<span><span class="co">#&gt; [18,40)       0.4         0.6</span></span>
<span><span class="co">#&gt; [40,65)       0.4         0.6</span></span>
<span><span class="co">#&gt; 65+           0.4         0.6</span></span></code></pre></div>
</details><div class="alert alert-warning">
<p><strong>Note</strong> that because there are two susceptibility groups, the <strong>susceptibility matrix</strong> has two columns. The corresponding <strong>demography-in-susceptibility matrix</strong> must also have two columns!</p>
<p><span class="math display">\[
4 \; demo. \; groups \left.\vphantom{\begin{matrix}
s_{1,1} &amp; s_{1,2} \\
s_{2,1} &amp; s_{2,2} \\
s_{3,1} &amp; s_{3,2} \\
s_{4,1} &amp; s_{4,2}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
s_{1,1} &amp; s_{1,2} \\
s_{2,1} &amp; s_{2,2} \\
s_{3,1} &amp; s_{3,2} \\
s_{4,1} &amp; s_{4,2}
\end{matrix}}^{\displaystyle 2 \; suscept. \; groups}
\quad
4 \; demo. \; groups \left.\vphantom{\begin{matrix}
p_{1,1} &amp; p_{1,2} \\
p_{2,1} &amp; p_{2,2} \\
p_{3,1} &amp; p_{3,2} \\
p_{4,1} &amp; p_{4,2}
\end{matrix}}\right\{
\overbrace{
\begin{matrix}
p_{1,1} &amp; p_{1,2} \\
p_{2,1} &amp; p_{2,2} \\
p_{3,1} &amp; p_{3,2} \\
p_{4,1} &amp; p_{4,2}
\end{matrix}}^{\displaystyle 2 \; suscept. \; groups}
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="case-4-susceptibility-varies-within-groups-in-different-proportion">Case 4: Susceptibility varies within groups in different proportion<a class="anchor" aria-label="anchor" href="#case-4-susceptibility-varies-within-groups-in-different-proportion"></a>
</h3>
<p>This scenario assumes that, in the population, there is different susceptibility to the infection:</p>
<ul>
<li><p>between individuals of different age groups from 20% (infants) to 100% (65+), and</p></li>
<li><p>within individuals of the same age group due the immunization effect of 25%.</p></li>
</ul>
<p>The immunization uptake rate is also different for each of the age groups: immunization increases with age from 20% (infants) to 90% (65+)</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">immunization_effect</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="co"># susceptibility matrix</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  unimmunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>immunised <span class="op">=</span> <span class="va">unimmunised</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">immunization_effect</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">susceptibility</span></span>
<span><span class="co">#&gt;         unimmunised immunised</span></span>
<span><span class="co">#&gt; [0,5)           0.2     0.150</span></span>
<span><span class="co">#&gt; [5,18)          0.5     0.375</span></span>
<span><span class="co">#&gt; [18,40)         0.6     0.450</span></span>
<span><span class="co">#&gt; [40,65)         0.9     0.675</span></span>
<span><span class="co">#&gt; 65+             1.0     0.750</span></span>
<span></span>
<span><span class="co"># demography-in-susceptibility matrix</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  immunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unimmunised <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">immunised</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_susceptibility</span></span>
<span><span class="co">#&gt;         immunised unimmunised</span></span>
<span><span class="co">#&gt; [0,5)         0.2         0.8</span></span>
<span><span class="co">#&gt; [5,18)        0.4         0.6</span></span>
<span><span class="co">#&gt; [18,40)       0.6         0.4</span></span>
<span><span class="co">#&gt; [40,65)       0.7         0.3</span></span>
<span><span class="co">#&gt; 65+           0.9         0.1</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="case-5-susceptibility-varies-within-three-groups">Case 5: Susceptibility varies within three groups<a class="anchor" aria-label="anchor" href="#case-5-susceptibility-varies-within-three-groups"></a>
</h3>
<p>This scenario assumes that, in the population, there is different susceptibility to the infection:</p>
<ul>
<li><p>between individuals of different age groups from 20% (infants) to 100% (65+), and</p></li>
<li><p>within individuals of the same age group due the immunization effect of 25% to the 40% of each of the age groups.</p></li>
</ul>
<p>Additionally, 10% of individuals in each of the age groups have 100% susceptibility, due to no immunization or not exposed to similar pathogens previously.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">immunization_effect</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="co"># susceptibility matrix</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  unimmunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>immunised <span class="op">=</span> <span class="va">unimmunised</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">immunization_effect</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">susceptibility</span></span>
<span><span class="co">#&gt;         susceptible unimmunised immunised</span></span>
<span><span class="co">#&gt; [0,5)             1         0.2     0.150</span></span>
<span><span class="co">#&gt; [5,18)            1         0.5     0.375</span></span>
<span><span class="co">#&gt; [18,40)           1         0.6     0.450</span></span>
<span><span class="co">#&gt; [40,65)           1         0.9     0.675</span></span>
<span><span class="co">#&gt; 65+               1         1.0     0.750</span></span>
<span></span>
<span><span class="co"># demography-in-susceptibility matrix</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[0,5)"</span>, <span class="st">"[5,18)"</span>, <span class="st">"[18,40)"</span>, <span class="st">"[40,65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>  susceptible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  immunised <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unimmunised <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">immunised</span> <span class="op">-</span> <span class="va">susceptible</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_susceptibility</span></span>
<span><span class="co">#&gt;         susceptible immunised unimmunised</span></span>
<span><span class="co">#&gt; [0,5)           0.1       0.4         0.5</span></span>
<span><span class="co">#&gt; [5,18)          0.1       0.4         0.5</span></span>
<span><span class="co">#&gt; [18,40)         0.1       0.4         0.5</span></span>
<span><span class="co">#&gt; [40,65)         0.1       0.4         0.5</span></span>
<span><span class="co">#&gt; 65+             0.1       0.4         0.5</span></span></code></pre></div>
</details><div class="alert alert-warning">
<p><strong>Recall</strong> that in the <strong>demography-in-susceptibility matrix</strong> (<code>p_susceptibility</code>) each row must always sum to 1.0!</p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-miller2012" class="csl-entry">
Miller, Joel C. 2012. <span>“A Note on the Derivation of Epidemic Final Sizes.”</span> <em>Bulletin of Mathematical Biology</em> 74 (9): 2125–41. <a href="https://doi.org/10.1007/s11538-012-9749-6" class="external-link">https://doi.org/10.1007/s11538-012-9749-6</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik Gupte, Edwin Van Leeuwen, Adam Kucharski, Rosalind Eggo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
